"use strict";var KTDatatablesServerSide=function(){var n,o;const t="/postcategories";const i=document.getElementById("info_modal");i.addEventListener("hidden.bs.modal",function(){n.draw()});const r=new bootstrap.Modal(i),s=document.getElementById("modal_form");var h=function(){n=$("#kt_datatable_example_1").DataTable({select:{style:"multi",selector:'td:first-child input[type="checkbox"]',className:"row-selected"},ordering:!1,ajax:{method:"post",url:`${t}/getdata`},columns:[{data:"id",orderable:!1,render:function(n){return`
                            <div class="form-check form-check-sm form-check-custom form-check-solid">
                                <input class="form-check-input" type="checkbox" value="${n}" />
                            </div>`}},{data:"title"},{data:"id",orderable:!1,className:"text-end",render:function(n,t,i,r){let u='<div class="btn-group btn-group-sm px-2">';return u+=`<button class="btn btn-sm btn-icon btn-light-info" data-kt-docs-table-action="edit_row" data-bs-toggle="tooltip" title="ویرایش" data-index="${r.row}"><i class="bi bi-pen"></i></button>`,u+=`<button class="btn btn-sm btn-icon btn-light-danger" data-kt-docs-table-action="delete_row" data-bs-toggle="tooltip" title="حذف" data-id="${n}"><i class="bi bi-trash"></i></button>`,u+"<\/div>"}},],createdRow:function(){}});o=n.$;n.on("draw",function(){f();e();u();KTMenu.createInstances();KTApp.initBootstrapTooltips()})},c=function(){const n=document.querySelector('[data-kt-docs-table-toolbar="add"]');n.addEventListener("click",function(){s.reset();r.show()})},l=function(){const t=document.querySelector('[data-kt-docs-table-filter="search"]');t.addEventListener("keyup",function(t){n.search(t.target.value).draw()})},u=()=>{const i=document.querySelectorAll('[data-kt-docs-table-action="delete_row"]'),u=document.querySelectorAll('[data-kt-docs-table-action="edit_row"]');i.forEach(i=>{i.addEventListener("click",function(i){i.preventDefault();let r=i.target.closest("button").dataset.id;SwalConfirm.fire().then(function(i){i.value&&fetch(`${t}/delete?id=${r}`).then(n=>n.json()).then(t=>{t.status==1?(toastr.success(t.message),n.draw()):(toastr.error(t.message),t.errors.forEach(n=>{toastr.warning(n)}))}).catch(()=>toastr.error("خطای سرور"))})})});u.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();let i=t.target.closest("button").dataset.index;document.querySelector('input[name="title"]').value=n.row(i).data().title;document.querySelector('input[name="id"]').value=n.row(i).data().id;r.show()})})},a=()=>{const t=document.querySelector('[data-kt-docs-table-select="deselect"]'),i=document.querySelector("#kt_datatable_example_1");t.addEventListener("click",function(){const t=i.querySelectorAll('[type="checkbox"]')[0];t.checked=!1;n.draw()})},f=function(){const u=document.querySelector("#kt_datatable_example_1"),f=u.querySelectorAll('[type="checkbox"]'),o=document.querySelector('[data-kt-docs-table-select="delete_selected"]'),i=document.querySelector('[data-kt-docs-table-progress="progressbar"]'),r=document.querySelector('[data-kt-docs-table-progress="base"]');f.forEach(n=>{n.addEventListener("click",function(){setTimeout(function(){e()},50)})});o.addEventListener("click",function(){SwalConfirm.fire().then(function(u){if(u.value){r.classList.remove("d-none");let u=0,f=n.rows({selected:!0}).data().count();i.style.width=`${parseInt(u/f*100)}%`;i.innerHTML=`${parseInt(u/f*100)}%`;let e=[];for(let r=0;r<f;r++)e.push(fetch(`${t}/delete/${n.rows({selected:!0}).data()[r].id}`).then(n=>n.json()).then(()=>{u++,i.style.width=`${parseInt(u/f*100)}%`,i.innerHTML=`${parseInt(u/f*100)}%`}).catch(()=>toastr.error("خطای سرور")));Promise.all(e).then(function(){n.draw();setTimeout(()=>{r.classList.add("d-none"),toastr.success("عملیات انجام شد")},543)}).catch(()=>toastr.error("خطای سرور"))}})})},e=function(){const u=document.querySelector("#kt_datatable_example_1"),n=document.querySelector('[data-kt-docs-table-toolbar="base"]'),t=document.querySelector('[data-kt-docs-table-toolbar="selected"]'),f=document.querySelector('[data-kt-docs-table-select="selected_count"]'),e=u.querySelectorAll('tbody [type="checkbox"]');let i=!1,r=0;e.forEach(n=>{n.checked&&(i=!0,r++)});i?(f.innerHTML=r,n.classList.add("d-none"),t.classList.remove("d-none")):(n.classList.remove("d-none"),t.classList.add("d-none"))};return{init:function(){h();l();f();u();a();c()}}}(),KTDocsAdd;KTUtil.onDOMContentLoaded(function(){KTDatatablesServerSide.init()});KTDocsAdd=function(){const r="/postcategories",n=document.getElementById("info_modal"),t=n.querySelector("#modal_form"),i=new bootstrap.Modal(n,{backdrop:"static"});return{init:function(){(()=>{var f=FormValidation.formValidation(t,{fields:{title:{validators:{notEmpty:{message:"نام دسته بندی را وارد نکرده اید"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}});const u=n.querySelector('[data-kt-docs-modal-action="submit"]');u.addEventListener("click",n=>{n.preventDefault(),f&&f.validate().then(function(n){console.log("validated!");"Valid"==n?(u.setAttribute("data-kt-indicator","on"),u.disabled=!0,fetch(`${r}/upsert`,{method:"POST",body:new FormData(t)}).then(n=>n.json()).then(t=>{u.removeAttribute("data-kt-indicator"),u.disabled=!1,console.log(t.status==1),t.status==1?(toastr.success(t.message),n.isConfirmed,i.hide()):(toastr.error(t.message),t.errors.forEach(n=>{toastr.warning(n)}))}).catch(()=>toastr.error(result.message))):toastr.warning("لطفا اطلاعات فرم را تکمیل کنید")})});n.querySelector('[data-kt-docs-modal-action="cancel"]').addEventListener("click",n=>{n.preventDefault(),i.hide()})})()}}}();KTUtil.onDOMContentLoaded(function(){KTDocsAdd.init()});